<!doctype html>
<html lang="en" domain="blog.axelerator.de" >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="/assets/js/highlight/styles/default.css">
    <link rel="stylesheet" href="/assets/css/tufte.min.css"/>
    <link rel="stylesheet" href="/assets/css/styles.css"/>
    <link rel="icon" type="image/png" href="/favicon.png">
    <title>Episode 11: Game Over</title>
  </head>
  <body class="tetris-game-over">
    <header>
      <div id="bg">axelerator.de</div>
      <nav>
  <div class="pages">
  
    <div><a href="/de">Home</a></div>
  
    <div><a href="/Ã¼ber">Ãœber</a></div>
  
  </div>
  <div class="links">
    <a href="/feed.xml"><span class="rss"/></a>
    <a href="https://twitter.com/TheAxelerator"><span class="twitter"/></a>
    <a href="https://github.com/axelerator"><span class="github"/></a>
    <a href="https://www.linkedin.com/in/axel-tetzlaff"><span class="linkedin"/></a>
    <a href="https://www.youtube.com/channel/UCQFzW6LFfreLOYI9-3QV2xg"><span class="youtube"/></a>
    <a href="https://www.twitch.tv/programmingisfun"><span class="twitch"/></a>
  </div>
  <div id="lang-picker">
    <label class="current" for="lang-toggle">ğŸ‡©ğŸ‡ª</label>
    <input type="checkbox" id="lang-toggle">
    <ul>
      
      
        
      
        
          <li>
            <a href="/elm/en/tetris-game-over" class="en">ğŸ‡ºğŸ‡¸</a>
          </li>
        
      
    </ul>

  </div>

</nav>




    </header>
    <main>
     <article>
       <h1>Episode 11: Game Over</h1>
       
<label for="post-meta" class="margin-toggle">&#8853;</label>
<input type="checkbox" id="post-meta"  class="margin-toggle"/>
<span class="marginnote">
23 September 2021
<br/>

  
  <a href="/tags#elm">elm</a>

</span>



<section>
<section>
<p><img src="/assets/posts/tetris-game-over/game-over.gif" style="float:right; margin: 5px 10px 10px 0" />
Noch fehlen ein paar Elemente damit unser Tetris â€˜vollstÃ¤ndigâ€™ ist. Aber zumindest kÃ¶nnen wir nach <a href="https://youtu.be/To2MtBs3w6A">Episode 11 (40min)</a> sagen â€œGame Overâ€.</p>

<p>Die Code-Ã„nderungen von dieser Woche gibt es im <a href="https://github.com/axelerator/elm-tetris/tree/episode11">episode11 Branch</a> bzw <a href="https://github.com/axelerator/elm-tetris/commit/8838b88b82af29c95ac3a0bfafe17eba27b254b9">Commit</a>.</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/To2MtBs3w6A" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<p>Diese Woche habe ich keine groÃŸartig neuen Konzepte genutzt. Aber gerade das ist etwas wo sich <em>Elm</em> von vielen anderen Sprachen abgrenzt. Die Syntax ist verhÃ¤ltnismÃ¤ÃŸig Ã¼bersichtlich. In anderen Sprachen wie Ruby oder Python finden wir mehrere Dogmen (objektorientiert und funktional). 
Daher ergeben sich auch mehrere AnsÃ¤tze ein Problem zu lÃ¶sen von denen nicht unbedingt einer mehr oder weniger den Prinipien der Sprache entsprechen muss. Der ganzheitlich funktionale Ansatz von Elm fÃ¼hrt zu einheitlicheren LÃ¶sungen. Das hilft es schneller Code zu verstehen, den man nicht selber geschrieben hat. Und natÃ¼rlich auch selber besser verstÃ¤ndlichen Code zu schreiben.</p>

<p>Dennoch gibt es natÃ¼rlich auch innerhalb der Syntax noch genÃ¼gend unterschiedliche MÃ¶glichkeiten sich auszudrÃ¼cken. Ein Werkzeug an das ich hÃ¤ufig erst im zweiten Durchgang denke ist das <em>pattern matching</em>.</p>

<p>Die wichtigste Ã„nderung war die Ã„nderung des zentralen <code class="language-plaintext highlighter-rouge">Model</code> Typs von einem <em>alias</em> zu eine <em>algebarischen Datentypen</em>.</p>

<p><em>vorher</em>:</p>
<pre><code class="language-Elm">type alias Model =
  { board : Board
  , currentPiece : Maybe CurrentPiece
  }
</code></pre>

<p><em>nachher</em>:</p>
<pre><code class="language-Elm">type Model =
    = RunningGame GameDetails
    | GameOver Board
</code></pre>

<p>Auch wenn der <em>â€œInhaltâ€</em> der beiden Varianten nahezu identisch ist lohnt es sich <strong>jetzt</strong> eine klare Unterscheidung zwischen den beiden ZustÃ¤nden einzufÃ¼hren. Eine ganze Reihe von Operationen, beziehungweise Ereignissen machen keinen Sinn mehr wenn das Spiel zu Ende ist.
Indem wir dies als eigene Variante ausdrÃ¼cken ermÃ¶glichen wir es dem Compiler uns zu â€œallen Stellen zu fÃ¼hrenâ€ an denen wir unsere Logik daraufhin untersuchen sollten.</p>

<p>Ein zentrale Stelle ist die <code class="language-plaintext highlighter-rouge">update</code> Funktion. Wie im Stream erwÃ¤hnt habe ich mir die Awendung des <em>pattern matching</em> fÃ¼r die <a href="https://github.com/rtfeldman/elm-spa-example"><code class="language-plaintext highlighter-rouge">update</code> Funktion</a> bei <a href="https://twitter.com/rtfeldman">Richard Feldman</a> abgeschaut.
Sein <a href="https://github.com/rtfeldman/elm-spa-example"><em>Elm SPA example</em></a> ist eine vollstÃ¤ndige Elm Anwendung bei der man sich einige gute Muster abschauen kann.</p>

<p>Der Anfang der <code class="language-plaintext highlighter-rouge">update</code> Funktion:</p>

<pre><code class="language-Elm">update : Msg -&gt; Model -&gt; ( Model, Cmd Msg )
update msg model =
  case msg of
    GravityTick _ -&gt;
      dropCurrentPiece model
</code></pre>

<p>sieht nach der Bearbeitung wie folgt aus:</p>
<pre><code class="language-Elm">update : Msg -&gt; Model -&gt; ( Model, Cmd Msg )
update msg model =
  case ( msg, model ) of
    ( GravityTick _, RunningGame gameDetails ) -&gt;
      dropCurrentPiece gameDetails
</code></pre>

<p>In dem wir den Ausdruck zwischen <code class="language-plaintext highlighter-rouge">case</code> und <code class="language-plaintext highlighter-rouge">of</code> auf ein Tupel von der <code class="language-plaintext highlighter-rouge">msg</code> <strong>und</strong> dem aktuellen <code class="language-plaintext highlighter-rouge">model</code> erweitern kÃ¶nnen wir jetzt in jedem Zweig neben der Nachricht auch mit dem aktuellen Spielzustand vergleichen.</p>

<p>Desweiteren fÃ¼gen wir einen Zweig hinzu der fÃ¼r alle Kombinationen aufgerufen wird die wir <em>nicht</em> explizit erwÃ¤hnen.</p>

<p>So ergibt sich die angenehme Situation, dass wir ungÃ¼ltige Kombinationen, wie zum Beispiel <code class="language-plaintext highlighter-rouge">(KeyDown key, GameOver)</code> nicht spezifieren brauchen.</p>

<p>Das heiÃŸt am Ende kommen wir mit weniger Code aus. Weniger Code ist natÃ¼rlich immer erstrebenswert. Allerdings hat diese LÃ¶sung auch einen Nachteil.
In der vorherigen Version weist uns der Compiler auf einen fehlenden Zweig in der <code class="language-plaintext highlighter-rouge">update</code> Funktion hin sobald wir eine neue Variante fÃ¼r unseren <code class="language-plaintext highlighter-rouge">Msg</code> Datentypen hinzufÃ¼gen. Das tut er in der Ã¼berarbeiteten Version nun nicht mehr, da wir mit dem <code class="language-plaintext highlighter-rouge">_ -&gt; ...</code> Zweig ja ein â€œpassendesâ€ Muster haben.
Man muss also bei der Anwedung dieser Optimierung gut Ã¼berlegen was einem wichtiger ist.</p>

<ul>
  <li>Wieviele Zweige muss ich explizit aufzÃ¤hlen falls ich ohne den <code class="language-plaintext highlighter-rouge">_ -&gt; ..</code> Zweig arbeite?</li>
  <li>Wie einfach ist es die Stellen zu finden die angefasst werden mÃ¼ssen, wenn ich <strong>mit</strong> dem <code class="language-plaintext highlighter-rouge">_ -&gt; ..</code> Zweig arbeite?</li>
</ul>


</section>

</section>
<div id="remark42"></div>
<script>
  var remark_config = {
    host: 'https://comments.axelerator.de',
    site_id: 'comments',
  }
</script>
<script>!function(e,n){for(var o=0;o<e.length;o++){var r=n.createElement("script"),c=".js",d=n.head||n.body;"noModule"in r?(r.type="module",c=".mjs"):r.async=!0,r.defer=!0,r.src=remark_config.host+"/web/"+e[o]+c,d.appendChild(r)}}(remark_config.components||["embed"],document);</script>


     </article>
    </main>
  </body>
  <script src="/assets/js/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script data-goatcounter="https://goatcounter.axelerator.de/count"
        async src="//goatcounter.axelerator.de/count.js"></script>
</html>

