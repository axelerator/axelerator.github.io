<!doctype html>
<html lang="en" domain="blog.axelerator.de" >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="/assets/js/highlight/styles/default.css">
    <link rel="stylesheet" href="/assets/css/tufte.min.css"/>
    <link rel="stylesheet" href="/assets/css/styles.css"/>
    <link rel="icon" type="image/png" href="/favicon.png">
    <title>Episode 2: Rendering the empty board and partial function application</title>
  </head>
  <body class="basic-board">
    <header>
      <div id="bg">axelerator.de</div>
      <nav>
  <div class="pages">
  
    <div><a href="/">Home</a></div>
  
    <div><a href="/about">About</a></div>
  
  </div>
  <div class="links">
    <a href="/feed.xml"><span class="rss"/></a>
    <a href="https://twitter.com/TheAxelerator"><span class="twitter"/></a>
    <a href="https://hachyderm.io/@axelerator"><span class="fediverse"/></a>
    <a href="https://github.com/axelerator"><span class="github"/></a>
    <a href="https://www.linkedin.com/in/axel-tetzlaff"><span class="linkedin"/></a>
    <a href="https://www.youtube.com/channel/UCQFzW6LFfreLOYI9-3QV2xg"><span class="youtube"/></a>
    <a href="https://www.twitch.tv/programmingisfun"><span class="twitch"/></a>
  </div>
  <div id="lang-picker">
    <label class="current" for="lang-toggle">üá∫üá∏</label>
    <input type="checkbox" id="lang-toggle">
    <ul>
      
      
        
          <li>
            <a href="/elm/de/board" class="de">üá©üá™</a>
          </li>
        
      
        
      
    </ul>

  </div>

</nav>




    </header>
    <main>
     <article>
       <h1>Episode 2: Rendering the empty board and partial function application</h1>
       <div class="meta"> 
  <div title="Reading time">3 minutes</div>
  <div>
  
    
    <a href="/tags#elm">#elm</a>
  
  </div>
  <div>7 July 2021</div>
</div>


<section>
<p>After we looked at the structure of an Elm app line by line last week, we had a more abstract look at the mechanics of an Elm app today. But after that we jumped right into the code that would render the empty Tetris board.</p>

<p><a href="/assets/posts/basic-board/architecture.png"><img src="/assets/posts/basic-board/architecture.png" width="300" /></a></p>

<p>The state of the code at the end of the episode is available on the <a href="https://github.com/axelerator/elm-tetris/tree/episode2">episode2 branch on Github</a></p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/rJXE328qYz8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<p>The development of an Elm application starts most of the time with thoughts about the central data types. That does not mean we have to know <strong>all</strong> the types and definitions from the begining though. We start with a very limited model that only contains what‚Äôs necessary for our first goal: A board of empty rows. I have high confidence that the strong type system of Elm will support me to quickly develop the data model without introducing regressions.</p>

<p>There was one aspect that we looked at that I‚Äôd like to give a bit more context on. The way function are declared in Elm might seem a bit alien to users of more classic programming languages.</p>

<pre><code class="language-Elm">fieldView : Int -&gt; Int -&gt; Html Msg
fieldView row column =
  rect [x (col * 10), y (row * 10)] []
</code></pre>

<p>The first row is the signature of the function and it can be read like this:</p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">fieldView</code> is a function with two parameters of type <code class="language-plaintext highlighter-rouge">Int</code>
and it returns a value of type <code class="language-plaintext highlighter-rouge">Html Msg</code> .</p>
</blockquote>

<h2 id="but-why-are-the-parameter-types-not-enclosed-in-parenthesis-like-in-a-normal-language">‚ÄúBut why are the parameter Types not enclosed in parenthesis like in a normal language?‚Äù</h2>
<p>The reason for that is, that this is not the only way the signature can be interpreted!
You could also read it like this:</p>

<blockquote>
  <p><code class="language-plaintext highlighter-rouge">fieldView</code> is a function that recieves <strong>one</strong> <code class="language-plaintext highlighter-rouge">Int</code> parameter.
The return value is a (new) <strong>function</strong> that recieves one (the other) parameter of type <code class="language-plaintext highlighter-rouge">Int</code>
and returns an <code class="language-plaintext highlighter-rouge">Html Msg</code>.</p>
</blockquote>

<p>Pratically speaking that means <code class="language-plaintext highlighter-rouge">fieldView</code> will return <strong>either</strong> an <code class="language-plaintext highlighter-rouge">Html</code> value <strong>or</strong> a function depending on with how many parameters we call it.</p>

<h2 id="but-what-is-that-good-for">‚ÄúBut what is that good for!?‚Äù</h2>

<p>Using this principle is called <em>partial application</em>. And it only really shows its strength when we use it in combination with functions that expect other functions as parameter.</p>

<p>The most prominent example from this family of function is <a href="https://package.elm-lang.org/packages/elm/core/latest/Array#map">map</a>.
It applies a given function to each element in a list.</p>

<p>A simplified version of the function that renders the board looks like this:</p>

<pre><code class="language-Elm">boardView : Html Msg
boardView =
  let
    rowNumbers = range 0 20
  in
    map rowView rowNumbers

rowView : Int -&gt; Html Msg
rowView rowNumber =
  let
    columnNumbers = range 0 10
  in
    map fieldView columnNumbers

fieldView : Int -&gt; Int -&gt; Html Msg
fieldView row column =
  rect [x (col * 10), y (row * 10)] []
</code></pre>

<p>This code will actually not compile, because the return value of <code class="language-plaintext highlighter-rouge">rowView</code> doesn‚Äôt match with what we‚Äôve declared.
We‚Äôre calling <code class="language-plaintext highlighter-rouge">map</code> with <code class="language-plaintext highlighter-rouge">fieldView</code>. A function that will return another function when we call it with <strong>one</strong> <code class="language-plaintext highlighter-rouge">Int</code>.
But we need to get an <code class="language-plaintext highlighter-rouge">Html</code> back!. The solution is to <em>‚Äúbake in‚Äù</em> the rowNumber into <code class="language-plaintext highlighter-rouge">fieldView</code> and create a new function that only expects the columnNumber.</p>

<p>A very verbose way to do this could look like this:</p>

<pre><code class="language-Elm">-- takes *one* Int
-- returns a function that turns another Int into Html 
fieldInRow : Int -&gt; (Int -&gt; Html Msg)
fieldInRow rowNumber = fieldView rowNumber -- this is partial application 

rowView : Int -&gt; Html Msg
rowView rowNumber =
  let
    columnNumbers = range 0 10
  in
    map (fieldInRow rowNumber) columnNumbers
</code></pre>

<p>And now comes the <img src="/assets/mindblown.gif" alt="mind blown" /> moment.
If we remove the parenthesis in the definition of  <code class="language-plaintext highlighter-rouge">fieldInRow : Int -&gt; (Int -&gt; Html Msg)</code> we see it is exactly the same as
the defintion of <code class="language-plaintext highlighter-rouge">fieldView : Int -&gt; Int -&gt; Html Msg</code>.</p>

<p>And the functionality is also exactly the same. That‚Äôs why we can just leave the whole function <code class="language-plaintext highlighter-rouge">fieldInRow</code> away.</p>

<pre><code class="language-Elm">rowView : Int -&gt; Html Msg
rowView rowNumber =
  let
    columnNumbers = range 0 10
  in
    map (fieldView rowNumber) columnNumbers
</code></pre>

<p>That‚Äôs the power and beauty of partial function application!</p>

</section>

<div id="remark42"></div>
<script>
  var remark_config = {
    host: 'https://comments.axelerator.de',
    site_id: 'comments',
  }
</script>
<script>!function(e,n){for(var o=0;o<e.length;o++){var r=n.createElement("script"),c=".js",d=n.head||n.body;"noModule"in r?(r.type="module",c=".mjs"):r.async=!0,r.defer=!0,r.src=remark_config.host+"/web/"+e[o]+c,d.appendChild(r)}}(remark_config.components||["embed"],document);</script>


     </article>
    </main>
  </body>
  <script src="/assets/js/highlight/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script data-goatcounter="https://goatcounter.axelerator.de/count"
        async src="//goatcounter.axelerator.de/count.js"></script>
</html>

